<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cashivo - Profile</title>
    <link rel="stylesheet" href="css/modern-styles.css" />
    <link rel="stylesheet" href="css/profile-enhancements.css" />
    <script type="module" src="js/profile.js" defer></script>
</head>
<body>
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <a href="index.html" class="logo" aria-label="Cashivo Home">Cashivo</a>
            <div class="nav-links" role="menubar">
                <a href="dashboard-mvp.html" role="menuitem" tabindex="0">Dashboard</a>
                <a href="profile.html" class="active" role="menuitem" tabindex="0" aria-current="page">Profile</a>
                <a href="#" id="logoutBtn" role="menuitem" tabindex="0">Logout</a>
            </div>
        </div>
    </nav>

    <main class="container fade-in" role="main" tabindex="-1">
        <!-- Profile Completion Progress -->
        <section class="profile-completion" aria-labelledby="completion-header">
            <div class="completion-header">
                <h3 id="completion-header">Profile Completion</h3>
                <span class="completion-percentage" id="completionPercentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="completionProgress"></div>
            </div>
            <div class="completion-items">
                <div class="completion-item" id="profileComplete">
                    <i class="fas fa-user"></i> Profile Info
                </div>
                <div class="completion-item" id="avatarComplete">
                    <i class="fas fa-camera"></i> Profile Picture
                </div>
                <div class="completion-item" id="preferencesComplete">
                    <i class="fas fa-cog"></i> Preferences
                </div>
                <div class="completion-item" id="securityComplete">
                    <i class="fas fa-shield-alt"></i> Security
                </div>
            </div>
        </section>

        <!-- Enhanced Profile Header -->
        <section class="profile-header-section" aria-labelledby="profile-main-header">
            <div class="profile-header">
                <div class="profile-avatar-section">
                    <div class="avatar-container">
                        <img id="headerAvatar" src="/assets/default-avatar.png" alt="User Avatar" class="profile-avatar-large" />
                        <div class="avatar-status">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="avatar-actions">
                            <button id="quickAvatarBtn" class="btn-icon" aria-label="Change avatar">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="profile-info">
                    <h2 id="profile-main-header" id="profileDisplayName">User</h2>
                    <p class="profile-email" id="profileEmailDisplay">user@example.com</p>
                    <div class="profile-badges">
                        <div class="badge">
                            <i class="fas fa-calendar-alt"></i>
                            <span id="memberSinceDate">Member since: Loading...</span>
                        </div>
                        <div class="badge">
                            <i class="fas fa-star"></i>
                            <span>Premium User</span>
                        </div>
                    </div>
                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-label">Transactions</div>
                            <div class="stat-value" id="totalTransactionCount">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Balance</div>
                            <div class="stat-value" id="monthlyBalance">₹0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Savings Rate</div>
                            <div class="stat-value" id="savingsRate">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Account Statistics -->
        <section class="stats-section" aria-labelledby="stats-header">
            <header class="section-header">
                <h2 id="stats-header">Account Statistics</h2>
            </header>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">Total Income</div>
                    <div class="stat-value" id="totalIncomeAmount">₹0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Total Expenses</div>
                    <div class="stat-value" id="totalExpensesAmount">₹0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Avg Monthly Spending</div>
                    <div class="stat-value" id="avgMonthlySpending">₹0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Active Budgets</div>
                    <div class="stat-value" id="activeBudgetsCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Active Goals</div>
                    <div class="stat-value" id="activeGoalsCount">0</div>
                </div>
            </div>
        </section>

        <!-- Recent Activity -->
        <section class="activity-section" aria-labelledby="activity-header">
            <header class="section-header">
                <h2 id="activity-header">Recent Activity</h2>
            </header>
            <div class="activity-feed" id="activityFeed">
                <!-- Activity items will be populated by JavaScript -->
            </div>
        </section>

        <!-- Financial Insights -->
        <section class="insights-section" aria-labelledby="insights-header">
            <header class="section-header">
                <h2 id="insights-header">Financial Insights</h2>
            </header>
            <div class="insights-grid" id="financialInsights">
                <!-- Insights will be populated by JavaScript -->
            </div>
        </section>

        <!-- Profile Information Form -->
        <section aria-labelledby="profile-info-header" class="profile-section">
            <header id="profile-info-header" class="section-header">
                <h2>Profile Information</h2>
            </header>
            <form id="profileInfoForm" aria-label="Update profile information" novalidate>
                <div class="form-group">
                    <label for="fullName" class="form-label">Full Name</label>
                    <input type="text" id="fullName" name="fullName" class="form-input" required aria-required="true" aria-describedby="fullNameError" />
                    <span id="fullNameError" class="error" aria-live="polite"></span>
                </div>
                <div class="form-group">
                    <label for="email" class="form-label">Email (read-only)</label>
                    <input type="email" id="email" name="email" class="form-input" readonly aria-readonly="true" />
                </div>
                <div class="form-group">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="tel" id="phone" name="phone" class="form-input" aria-describedby="phoneHelp phoneError" />
                    <small id="phoneHelp" class="form-text">Optional</small>
                    <span id="phoneError" class="error" aria-live="polite"></span>
                </div>
                <div class="form-group">
                    <label for="timezone" class="form-label">Timezone</label>
                    <select id="timezone" name="timezone" class="form-select" aria-required="true" aria-describedby="timezoneHelp">
                        <!-- Timezone options dynamically populated by JS or server -->
                    </select>
                    <small id="timezoneHelp" class="form-text">Select your timezone</small>
                </div>
                <button type="submit" class="btn btn-primary">Update Profile</button>
            </form>
        </section>

        <!-- Preferences -->
        <section aria-labelledby="preferences-header" class="preferences-section">
            <header id="preferences-header" class="section-header">
                <h2>Preferences</h2>
            </header>
            <form id="preferencesForm" aria-label="Update user preferences" novalidate>
                <div class="form-group">
                    <label for="currency" class="form-label">Currency</label>
                    <select id="currency" name="currency" class="form-select" aria-required="true">
                        <option value="INR">INR - Indian Rupee</option>
                        <option value="USD">USD - US Dollar</option>
                        <option value="EUR">EUR - Euro</option>
                        <!-- Add more currencies as needed -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="dateFormat" class="form-label">Date Format</label>
                    <select id="dateFormat" name="dateFormat" class="form-select" aria-required="true">
                        <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="theme" class="form-label">Theme</label>
                    <select id="theme" name="theme" class="form-select" aria-required="true">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="auto">Auto</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="language" class="form-label">Language</label>
                    <select id="language" name="language" class="form-select" aria-required="true">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <!-- Add more languages as needed -->
                    </select>
                </div>
                <div class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="budgetAlerts" name="budgetAlerts" />
                        Budget Alerts
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="goalAlerts" name="goalAlerts" />
                        Goal Alerts
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="emailNotifications" name="emailNotifications" />
                        Email Notifications
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="soundEnabled" name="soundEnabled" />
                        Sound Enabled
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="pushNotifications" name="pushNotifications" />
                        Push Notifications
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">Save Preferences</button>
            </form>
        </section>

        <!-- Profile Picture Upload -->
        <section aria-labelledby="avatar-header" class="avatar-section">
            <header id="avatar-header" class="section-header">
                <h2>Profile Picture</h2>
            </header>
            <div id="avatarUploadArea" class="avatar-upload-area" tabindex="0" aria-label="Drag and drop your avatar image here or use the buttons below to select and upload">
                <input type="file" id="avatarInput" name="avatarInput" accept="image/*" hidden />
                <div class="upload-instructions">
                    <p>Upload a new profile picture</p>
                    <small>Drag and drop an image here, or click the button below</small>
                </div>
                <button id="selectAvatarBtn" class="btn btn-secondary" type="button">Select Image</button>
                <button id="uploadAvatarBtn" class="btn btn-primary" type="button" disabled>Upload Avatar</button>
                <button id="deleteAvatarBtn" class="btn btn-danger" type="button">Delete Avatar</button>
                <p class="file-info">Supported formats: JPG, PNG, GIF. Max size: 2MB.</p>
            </div>
        </section>

        <!-- Security Settings -->
        <section aria-labelledby="security-header" class="security-section">
            <header id="security-header" class="section-header">
                <h2>Security</h2>
            </header>
            <div class="security-feature">
                <h4><i class="fas fa-shield-alt"></i> Two-Factor Authentication</h4>
                <p>Add an extra layer of security to your account</p>
                <div class="feature-status" id="2faStatus">Not Enabled</div>
                <button id="setup2FABtn" class="btn btn-secondary">Setup 2FA</button>
            </div>
            <div class="security-feature">
                <h4><i class="fas fa-key"></i> Change Password</h4>
                <p>Update your password to keep your account secure</p>
                <form id="changePasswordForm" aria-label="Change password" novalidate>
                    <div class="form-group">
                        <label for="newPassword" class="form-label">New Password</label>
                        <input type="password" id="newPassword" name="newPassword" class="form-input" required aria-required="true" aria-describedby="newPasswordError" />
                        <span id="newPasswordError" class="error" aria-live="polite"></span>
                    </div>
                    <div class="form-group">
                        <label for="confirmNewPassword" class="form-label">Confirm New Password</label>
                        <input type="password" id="confirmNewPassword" name="confirmNewPassword" class="form-input" required aria-required="true" aria-describedby="confirmNewPasswordError" />
                        <span id="confirmNewPasswordError" class="error" aria-live="polite"></span>
                    </div>
                    <div class="password-requirements" aria-live="polite" aria-atomic="true">
                        <p>Password must contain:</p>
                        <ul>
                            <li id="req-length">At least 8 characters</li>
                            <li id="req-uppercase">An uppercase letter</li>
                            <li id="req-lowercase">A lowercase letter</li>
                            <li id="req-number">A number</li>
                            <li id="req-special">A special character</li>
                        </ul>
                        <div class="password-strength-bar">
                            <div id="passwordStrengthFill" class="password-strength-fill"></div>
                        </div>
                        <p id="passwordStrengthText" class="strength-text">Weak</p>
                    </div>
                    <button type="submit" class="btn btn-primary">Change Password</button>
                </form>
            </div>
            <div class="security-feature">
                <h4><i class="fas fa-history"></i> Recent Login Activity</h4>
                <p>Monitor recent login attempts to your account</p>
                <div class="login-history" id="loginHistory">
                    <div class="login-item">
                        <i class="fas fa-desktop"></i>
                        <div>
                            <strong>Chrome on Windows</strong>
                            <br><small>Mumbai, India • 2 hours ago</small>
                        </div>
                    </div>
                    <div class="login-item">
                        <i class="fas fa-mobile-alt"></i>
                        <div>
                            <strong>Safari on iPhone</strong>
                            <br><small>Mumbai, India • 1 day ago</small>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Data Management -->
        <section aria-labelledby="data-management-header" class="data-management-section">
            <header id="data-management-header" class="section-header">
                <h2>Data Management</h2>
            </header>
            <div class="data-actions">
                <div class="action-group">
                    <h4>Export Your Data</h4>
                    <p>Download all your financial data for backup or analysis</p>
                    <div class="action-buttons">
                        <button id="exportAllBtn" class="btn btn-secondary">Export All Data</button>
                        <button id="exportTransactionsBtn" class="btn btn-secondary">Export Transactions</button>
                        <button id="exportPDFBtn" class="btn btn-secondary">Export PDF Report</button>
                    </div>
                </div>
                <div class="action-group">
                    <h4>Import Data</h4>
                    <p>Import transactions from CSV files</p>
                    <div class="action-buttons">
                        <button id="importDataBtn" class="btn btn-secondary">Import Data</button>
                    </div>
                </div>
                <div class="action-group danger-zone">
                    <h4>Danger Zone</h4>
                    <p>These actions cannot be undone</p>
                    <div class="action-buttons">
                        <button id="clearAllDataBtn" class="btn btn-danger">Clear All Data</button>
                        <button id="deleteAccountBtn" class="btn btn-danger">Delete Account</button>
                    </div>
                </div>
            </div>
        </section>

        <div id="toastContainer" aria-live="polite" aria-atomic="true" class="toast-container"></div>
    </main>

    <footer>
        <p>&copy; 2024 Cashivo. All rights reserved.</p>
    </footer>

    <!-- Font Awesome for icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
</body>
</html>
